# 歷經上萬次程式碼審查後——這些錯誤我每週依然常見

[歷經上萬次程式碼審查後——這些錯誤我每週依然常見 ! 作者：原子架構師 ! Medium --- 10,000 Code Reviews Later — These Are the Mista.pdf](../Card%20Library/歷經上萬次程式碼審查後——這些錯誤我每週依然常見%20!%20作者：原子架構師%20!%20Medium%20---%2010,000%20Code%20Reviews%20Later%20—%20These%20Are%20the%20Mista.pdf)

### 文章分析報告

#### 1\. 文章核心論點

本文的核心論點是，程式碼審查的價值遠不止於找出語法錯誤，它更是一項關乎團隊信任、合作與建立高標準的基礎工程。作者透過自身上萬次的審查經驗，強調真正有價值的審查是為了確保程式碼的長期健康、可維護性與可讀性，為未來的開發者（甚至未來的自己）鋪路。[\[1\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A586.74%2C%22top%22%3A994.7%2C%22width%22%3A565.7849999999999%2C%22height%22%3A69.6289999999999%7D)[\[2\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A607.695%2C%22top%22%3A5102.811%2C%22width%22%3A683.8950000000001%2C%22height%22%3A59.6820000000007%7D)[\[3\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A601.98%2C%22top%22%3A5202.281%2C%22width%22%3A596.2650000000001%2C%22height%22%3A59.6820000000007%7D)

#### 2\. 主要內容架構

這篇文章的架構清晰，從觀念建立到具體實踐，層層遞進：

- **前言：重新定義程式碼審查** 作者首先破題，指出程式碼審查不只是抓錯，而是一種掃描模式、訊號和潛在風險的過程，目的是避免未來可能付出的慘痛代價。[\[1\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A586.74%2C%22top%22%3A994.7%2C%22width%22%3A565.7849999999999%2C%22height%22%3A69.6289999999999%7D)[\[4\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A607.695%2C%22top%22%3A1094.17%2C%22width%22%3A678.18%2C%22height%22%3A89.52299999999991%7D)

- **中段：列舉常見的程式碼錯誤與改進方案** 此為文章主體，作者透過五個具體的程式碼案例，詳細說明了在審查中經常發現的錯誤類型，並提供更優良的寫法與設計模式作為對照。[\[5\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A594.36%2C%22top%22%3A1313.0040000000001%2C%22width%22%3A240.02999999999997%2C%22height%22%3A39.78800000000001%7D)

- **後段：提供有效的回饋技巧** 作者分享了如何在不引發爭論的情況下給予有建設性的審查回饋，強調溝通方式與內容同等重要。[\[6\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A598.17%2C%22top%22%3A4376.68%2C%22width%22%3A830.58%2C%22height%22%3A89.52300000000014%7D)

- **結論：闡述審查的最終目標** 文章結尾再次強調，優秀的程式碼審查目標是提升整個程式碼庫的健康與清晰度，這是一項對專案未來的長期投資。[\[2\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A607.695%2C%22top%22%3A5102.811%2C%22width%22%3A683.8950000000001%2C%22height%22%3A59.6820000000007%7D)[\[7\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A603.885%2C%22top%22%3A5291.804%2C%22width%22%3A582.9300000000001%2C%22height%22%3A89.52300000000014%7D)

#### 3\. 關鍵觀點整理

以下是作者在文章中提出的主要錯誤及其建議的解決方案：

- **潛伏的無聲崩潰風險**

   - **問題**：程式碼缺少對 `null` 值的檢查，一旦傳入空值就會導致整個系統崩潰。[\[8\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A594.36%2C%22top%22%3A1860.089%2C%22width%22%3A609.6%2C%22height%22%3A69.62900000000013%7D)

   - **例子**：一個處理發票列表的 `for` 迴圈，如果 `invoices` 本身是 `null` 就會出錯。[\[9\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A624.84%2C%22top%22%3A1531.838%2C%22width%22%3A575.3100000000001%2C%22height%22%3A179.04599999999982%7D)[\[8\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A594.36%2C%22top%22%3A1860.089%2C%22width%22%3A609.6%2C%22height%22%3A69.62900000000013%7D)

   - **解決方案**：在處理任何集合或物件前，先進行空值或空集合的判斷，並提前返回或記錄，避免程式繼續執行。[\[10\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A609.6%2C%22top%22%3A2078.923%2C%22width%22%3A605.7900000000001%2C%22height%22%3A268.56899999999996%7D)

- **隱藏的緊密耦合**

   - **問題**：類別直接依賴於一個具體的實作（例如，特定的支付服務商），導致未來更換供應商或進行單元測試時變得極為困難。[\[11\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A603.885%2C%22top%22%3A2815.0009999999997%2C%22width%22%3A541.02%2C%22height%22%3A59.682000000000244%7D)

   - **例子**：`OrderHandler` 類別直接在內部建立一個 `PaymentGateway` 的實例。[\[12\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A626.745%2C%22top%22%3A2616.061%2C%22width%22%3A525.7799999999999%2C%22height%22%3A129.31100000000015%7D)

   - **解決方案**：採用「依賴注入」（Dependency Injection），將具體的服務實例從外部傳入，使類別依賴於抽象（介面）而非實作，大幅提高程式碼的靈活性與可測試性。[\[11\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A603.885%2C%22top%22%3A2815.0009999999997%2C%22width%22%3A541.02%2C%22height%22%3A59.682000000000244%7D)[\[13\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A624.84%2C%22top%22%3A3003.9939999999997%2C%22width%22%3A440.0550000000002%2C%22height%22%3A188.9930000000004%7D)

- **隨時間失效的「魔法數字」**

   - **問題**：在程式碼中直接使用未經定義的數字（如稅率 `0.25`），這些數字意義不明，且當業務規則改變時，需要在多處手動修改，容易遺漏。[\[14\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A607.695%2C%22top%22%3A3342.192%2C%22width%22%3A325.7549999999999%2C%22height%22%3A49.73500000000013%7D)[\[15\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A598.17%2C%22top%22%3A3570.973%2C%22width%22%3A617.2200000000001%2C%22height%22%3A29.840999999999894%7D)

   - **例子**：`tax = salary * 0.25;`。[\[14\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A607.695%2C%22top%22%3A3342.192%2C%22width%22%3A325.7549999999999%2C%22height%22%3A49.73500000000013%7D)

   - **解決方案**：將這些數字定義為有意義的常數（例如 `HIGH_INCOME_TAX_RATE`），或更好的做法是將其放入設定檔中，方便在不重新部署的情況下修改。[\[16\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A634.365%2C%22top%22%3A3750.0190000000002%2C%22width%22%3A462.91499999999996%2C%22height%22%3A79.57600000000002%7D)[\[17\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A609.6%2C%22top%22%3A3919.1180000000004%2C%22width%22%3A662.9399999999999%2C%22height%22%3A29.840999999999894%7D)

- **過度工程師的陷阱**

   - **問題**：開發者基於對未來需求的猜測，編寫了當前並不需要的功能，導致系統變得複雜且充滿無用的程式碼。[\[18\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A594.36%2C%22top%22%3A4217.528%2C%22width%22%3A681.9900000000001%2C%22height%22%3A69.6289999999999%7D)

   - **例子**：在折扣功能還未納入開發範圍時，就已經完整實作了優惠券的處理機制。[\[18\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A594.36%2C%22top%22%3A4217.528%2C%22width%22%3A681.9900000000001%2C%22height%22%3A69.6289999999999%7D)

   - **解決方案**：作者的座右銘是「好好解決今天的問題，明天的問題等它真的來了再說」，避免為不存在的需求預先建構。[\[6\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A598.17%2C%22top%22%3A4376.68%2C%22width%22%3A830.58%2C%22height%22%3A89.52300000000014%7D)

#### 4\. 作者的論證邏輯

作者主要透過以下方式來支持其論點：

1. **建立權威性**：文章標題直接點出「10,000次程式審查」的經驗，讓讀者相信其觀點是基於大量實踐而非空談。[\[19\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A601.98%2C%22top%22%3A139.258%2C%22width%22%3A683.895%2C%22height%22%3A109.417%7D)

2. **實例驅動**：作者不只提出理論，而是為每一個常見錯誤都提供了簡潔、具體的「錯誤程式碼」與「改進後程式碼」對照，讓讀者能輕易理解問題所在與解決方案的優越性。[\[20\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A603.885%2C%22top%22%3A1422.4209999999998%2C%22width%22%3A312.41999999999996%2C%22height%22%3A39.78800000000001%7D)[\[21\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A603.885%2C%22top%22%3A2476.803%2C%22width%22%3A253.365%2C%22height%22%3A59.682000000000244%7D)[\[14\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A607.695%2C%22top%22%3A3342.192%2C%22width%22%3A325.7549999999999%2C%22height%22%3A49.73500000000013%7D)

3. **提供行動指南**：除了指出問題，作者還提供了「如何在不引發戰爭的情況下給予反饋」的具體溝通技巧，讓文章不僅具備技術深度，也包含軟技能的指導，提高了實用性。[\[6\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A598.17%2C%22top%22%3A4376.68%2C%22width%22%3A830.58%2C%22height%22%3A89.52300000000014%7D)[\[22\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A607.695%2C%22top%22%3A4704.931%2C%22width%22%3A659.13%2C%22height%22%3A99.47000000000025%7D)[\[23\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A607.695%2C%22top%22%3A4903.871%2C%22width%22%3A672.465%2C%22height%22%3A109.41700000000037%7D)

#### 5\. 可能的爭議或限制

儘管文章的建議非常實用，但在某些情境下可能存在以下限制：

- **情境的簡化**：為了清晰地說明觀點，文中的程式碼範例都經過高度簡化。在真實世界的複雜業務邏輯中，應用這些原則（如依賴注入）可能需要更完整的架構支持，並非總能如此直接地修改。

- **敏捷與完美的權衡**：在追求快速迭代的開發環境中，團隊有時可能會策略性地接受一些「技術債」（如暫時使用魔法數字），以換取更快的交付速度。文章的觀點偏向於追求程式碼的長期健康，這在某些需要快速驗證市場的專案初期可能不是最高優先級。

- **團隊文化差異**：作者提出的回饋技巧基於一個開放、尊重的團隊文化。在某些團隊中，即使採用了委婉的溝通方式，重大修改建議仍可能引發衝突，尤其是在接近截止日期時。[\[23\]](https://app.heptabase.com/f3c4fc0d-fe07-4b10-932c-6f968c1f5ab0/card/d8a99f40-c962-44ca-a375-945218f33ce4?pdfPage=1&pdfBoundingBox=%7B%22left%22%3A607.695%2C%22top%22%3A4903.871%2C%22width%22%3A672.465%2C%22height%22%3A109.41700000000037%7D)

### 值得思考的問題

1. **程式碼審查的時機**：你認為在開發流程的哪個階段引入程式碼審查最有效？是在每次提交（Commit）時，還是在一個功能完整開發後的一次性拉取請求（Pull Request）中？

2. **自動化與人工審查的界線**：文中提到的「缺少空值檢查」和「魔法數字」等問題，有多少可以透過靜態分析工具（Linter）自動發現並修正？人工審查應該更專注於哪些無法被工具取代的面向（例如：業務邏輯、架構設計）？

3. **「過度工程」與「前瞻設計」的平衡**：作者警告不要為不存在的需求寫程式碼，但在軟體設計中，適度的擴展性設計也是必要的。你認為團隊該如何界定「過度工程」與「有遠見的架構設計」之間的界線？
# æœ‰æ•ˆç”¢ç”Ÿ.xml

- **æ–¹æ³•ä¸€ï¼šä½¿ç”¨ Appium è‡ªå‹•ç¨‹å¼å–å¾— XML**

   - ç”¨ Python æˆ– Java ç·¨å¯« Appium scriptï¼Œ**è‡ªå‹•å•Ÿå‹• App â†’ å°èˆªåˆ°ç•«é¢ â†’ æ“·å– pageSourceï¼ˆXMLï¼‰â†’ å­˜æª”**

   - Appiumæä¾›äº†driver.getPageSource()æ–¹æ³•ï¼ˆåœ¨Pythonä¸­ç‚ºä¾‹ï¼Œå…¶ä»–èªè¨€é¡ä¼¼ï¼‰ï¼Œå¯ä»¥ç›´æ¥å¾ç¨‹å¼ç¢¼ä¸­ç²å–ç•¶å‰ç•«é¢çš„XMLçµæ§‹ã€‚

---

## **æ–¹æ³•äºŒï¼šéŒ„è£½ Appium Sessionï¼Œé‡æ’­ï¼‹æŠ“ XML**

ç•¶ç„¶å¯ä»¥ï¼é€™é‚Šæˆ‘æœƒå¹«ä½ åšä¸€å€‹ã€Œå¾ç•«é¢ XML è½‰æ›æˆ `.feature` æ¸¬è©¦æ¡ˆä¾‹ã€çš„å®Œæ•´ AI æ•´åˆæµç¨‹ã€‚æ•´é«”æµç¨‹å¦‚ä¸‹ï¼š

---

## ğŸ§© æ•´åˆæµç¨‹ï¼šç•«é¢ XML âœ å¯è®€ç•«é¢æè¿° âœ AI Prompt âœ `.feature` æ¡ˆä¾‹

---

## ğŸ”¹ç¬¬ 1 æ­¥ï¼šAppium æŠ“å–ç•«é¢ XMLï¼ˆä½ å¯èƒ½å·²ç¶“æœ‰ï¼‰

ç”¢å‡ºä¸€å€‹åƒé€™æ¨£çš„ `login_page.xml`ï¼š

```xml
<AppiumAUT>
  <XCUIElementTypeTextField name="username_input" label="Username" />
  <XCUIElementTypeSecureTextField name="password_input" label="Password" />
  <XCUIElementTypeButton name="login_button" label="Login" />
</AppiumAUT>
```

---

## ğŸ”¹ç¬¬ 2 æ­¥ï¼šXML âœ ç•«é¢æè¿°ï¼ˆAI å¯ç†è§£æ ¼å¼ï¼‰

ä½ å¯ä»¥ç”¨ Python åšç°¡å–®è§£æï¼Œä¹Ÿå¯ä»¥è®“ ChatGPT å¹«ä½ æ•´ç†ï¼ˆä»¥ä¸‹ä¹Ÿé©ç”¨æ–¼æ‰‹å‹•è½‰æ›ï¼‰ï¼š

```plaintext
[Login Page]
- TextField: Username (accessibilityId: "username_input")
- SecureTextField: Password (accessibilityId: "password_input")
- Button: Login (accessibilityId: "login_button")
```

---

## ğŸ”¹ç¬¬ 3 æ­¥ï¼šAI Prompt è¨­è¨ˆï¼ˆæ ¸å¿ƒï¼‰

```plaintext
ä½ æ˜¯ä¸€ä½ç¶“é©—è±å¯Œçš„è‡ªå‹•åŒ–æ¸¬è©¦å·¥ç¨‹å¸«ï¼Œè«‹æ ¹æ“šä»¥ä¸‹ iOS ç•«é¢å…ƒä»¶æè¿°ï¼Œç”¢ç”Ÿå°æ‡‰çš„ Cucumber `.feature` æ¸¬è©¦æ¡ˆä¾‹ï¼ˆGherkin èªæ³•ï¼‰ã€‚

éœ€æ±‚ï¼š
- æ¡ˆä¾‹ä»¥ä½¿ç”¨è€…è¦–è§’å‡ºç™¼ï¼Œæ¨¡æ“¬å…¸å‹æ“ä½œæµç¨‹
- ä½¿ç”¨ Given / When / Then æ ¼å¼æ’°å¯«
- è‹¥æœ‰æ¬„ä½ï¼Œè«‹æ¨¡æ“¬åˆç†çš„è¼¸å…¥è³‡æ–™
- è‹¥åŒ…å«æŒ‰éˆ•ï¼Œè«‹æè¿°é»æ“Šæ“ä½œèˆ‡çµæœ

ç•«é¢æè¿°å¦‚ä¸‹ï¼š

[Login Page]
- TextField: Username (accessibilityId: "username_input")
- SecureTextField: Password (accessibilityId: "password_input")
- Button: Login (accessibilityId: "login_button")

[Home Page]
- Label: Welcome Message
- Button: Logout
```

---

### âœ… é æœŸç”¢å‡º `.feature` ç¯„ä¾‹ï¼š

```gherkin
Feature: User login

  Scenario: Successful login with valid credentials
    Given the app is launched
    When the user enters "testuser" into the username field
    And the user enters "password123" into the password field
    And the user taps the login button
    Then the user should see the welcome message on the home page
```

---

## ğŸ”¹ç¬¬ 4 æ­¥ï¼šè‡ªå‹•åŒ–ï¼ˆå¯é¸ï¼‰

ä½ å¯ä»¥æŠŠé€™æµç¨‹å¯«æˆä¸€å€‹ç°¡å–®çš„ Python è…³æœ¬ï¼š

### ğŸ“‚ `generate_feature.py`

```python
import openai
import os

openai.api_key = os.getenv("OPENAI_API_KEY")

prompt_template = """
ä½ æ˜¯ä¸€ä½ç¶“é©—è±å¯Œçš„è‡ªå‹•åŒ–æ¸¬è©¦å·¥ç¨‹å¸«ï¼Œè«‹æ ¹æ“šä»¥ä¸‹ iOS ç•«é¢å…ƒä»¶æè¿°ï¼Œç”¢ç”Ÿå°æ‡‰çš„ Cucumber `.feature` æ¸¬è©¦æ¡ˆä¾‹ï¼ˆGherkin èªæ³•ï¼‰ã€‚

éœ€æ±‚ï¼š
- æ¡ˆä¾‹ä»¥ä½¿ç”¨è€…è¦–è§’å‡ºç™¼ï¼Œæ¨¡æ“¬å…¸å‹æ“ä½œæµç¨‹
- ä½¿ç”¨ Given / When / Then æ ¼å¼æ’°å¯«
- è‹¥æœ‰æ¬„ä½ï¼Œè«‹æ¨¡æ“¬åˆç†çš„è¼¸å…¥è³‡æ–™
- è‹¥åŒ…å«æŒ‰éˆ•ï¼Œè«‹æè¿°é»æ“Šæ“ä½œèˆ‡çµæœ

ç•«é¢æè¿°å¦‚ä¸‹ï¼š

{screen_description}
"""

def generate_feature(screen_description):
    prompt = prompt_template.format(screen_description=screen_description)

    response = openai.ChatCompletion.create(
        model="gpt-4",
        messages=[{"role": "user", "content": prompt}],
        temperature=0.4,
    )

    return response['choices'][0]['message']['content']

# ç¯„ä¾‹ç•«é¢æè¿°
login_screen = """
[Login Page]
- TextField: Username (accessibilityId: "username_input")
- SecureTextField: Password (accessibilityId: "password_input")
- Button: Login (accessibilityId: "login_button")

[Home Page]
- Label: Welcome Message
"""

feature_content = generate_feature(login_screen)

# å„²å­˜æˆ feature æª”
with open("login.feature", "w") as f:
    f.write(feature_content)

print("âœ… æ¸¬è©¦æ¡ˆä¾‹å·²ç”¢å‡º login.feature")
```

---

## âœ… å»¶ä¼¸åŠŸèƒ½ä½ å¯ä»¥åŠ å…¥ï¼š

| åŠŸèƒ½ | æ–¹æ³• | 
|---|---|
| å¤šç•«é¢ä¸€èµ·è½‰æ› | æ”¯æ´å¤šæ®µç•«é¢æè¿°è¿´åœˆå‘¼å« | 
| XML è‡ªå‹•è½‰ç•«é¢æè¿° | åŠ å…¥ Python çš„ ElementTree è‡ªå‹•è§£æ | 
| å­˜ç‚ºå¤šå€‹ `.feature` æª”æ¡ˆ | ç”¨ç•«é¢åç¨±è‡ªå‹•å‘½åè¼¸å‡ºæª” | 

---

å¦‚æœä½ çµ¦æˆ‘ä¸€å€‹å¯¦éš›çš„ XMLï¼ˆæˆ–ä½ æƒ³è½‰çš„ç•«é¢æ¸…å–®ï¼‰ï¼Œæˆ‘å¯ä»¥å¹«ä½ è·‘ä¸€æ¬¡é€™æ•´å€‹æµç¨‹ï¼

è¦ä¸è¦ä¾†å€‹ end-to-end ç¯„ä¾‹ï¼ŸğŸ”¥

## ç›®æ¨™ï¼š

å±•ç¤ºäº†å¦‚ä½•å¾Appium InspectoréŒ„è£½æ“ä½œé–‹å§‹ï¼Œè½‰æ›æˆBDDæ¸¬è©¦æ¡ˆä¾‹ï¼Œä¸¦å¯¦ä½œå¯åŸ·è¡Œçš„è…³æœ¬ã€‚é•·æœŸä¾†çœ‹ï¼Œä½ å¯ä»¥ï¼š

- **è·³éç”ŸæˆXML**ï¼Œç›´æ¥ä½¿ç”¨éŒ„è£½æ™‚ç²å–çš„å…ƒç´ å±¬æ€§ã€‚

- åˆ©ç”¨**AIç”ŸæˆGherkinèªæ³•**ï¼Œæ¸›å°‘æ‰‹å‹•æ’°å¯«.featureçš„æ™‚é–“ã€‚

- å°è£**é€šç”¨æ­¥é©Ÿ**ï¼Œæå‡è…³æœ¬çš„å¯ç¶­è­·æ€§ã€‚


